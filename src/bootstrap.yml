variant: fcos
version: 1.0.0
# ignition: 
#   config:
#     merge:
#       - source: https://raw.githubusercontent.com/gtherond/ignition/master/build/runtime.ign

# Allowing a remote privileged user login for DEBUG and RECOVERY purpose, this key should be stored securely and only available to
# a restricted amount of authorized and properly identified people.
passwd:
  users:
    - name: core
      ssh_authorized_keys:
        - "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAICuOd04cEYQXzbnR+bXsKWhHqrcUkTMOodP62JcZPMN2"

# Create an update wariness and reboot strategy, as we're not in a clustered environment we don't use fleet_lock reboot strategy.
# Give the seedbox a static name as it needs to be easily discoverable either using DNS or mDNS.
# Install required common containers.
storage:
  files:
    - path: /etc/hostname
      mode: 0640
      contents:
        inline: |
          ns1.bitswalk.net

    - path: /etc/zincati/config.d/51-rollout-wariness.toml
      mode: 0640
      contents:
        inline: |
          [identity]
          rollout_wariness = 0.5

    - path: /etc/zincati/config.d/55-updates-strategy.toml
      mode: 0640
      contents:
        inline: |
          [updates]
          strategy = "immediate"

    - path: /var/lib/vault/config/config.json
      mode: 0640
      overwrite: true
      contents:
        source: https://raw.githubusercontent.com/gtherond/ignition/master/config/secretsManager/config.json